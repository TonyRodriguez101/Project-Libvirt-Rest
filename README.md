{"id":16204,"uuid":"07344816-38cd-44da-ac50-b034da9bf438","user_id":11451,"filename":"scripts.py","source":"Multiple","generated":"# \ud83d\udcdc Virtual Machine Manager API Documentation\n\nWelcome to the Virtual Machine Manager API documentation! This API provides a set of endpoints for managing virtual machines (VMs) using libvirt and qemu. You can create, modify, start, stop, delete, export, import, and list VMs with this API.\n\n## \ud83d\udcd1 Index\n\n1. Overview\n2. Endpoints\n - Create VM\n - Modify VM\n - Unmount ISO\n - List VMs\n - Delete VM\n - Start VM\n - Stop VM\n - Export VM\n - Export VM Compressed\n - Import VM\n - Import VM Compressed\n\n---\n\n## Overview\n\nThis API is built using Flask and provides functionalities to manage virtual machines using the libvirt library. The virtual machines are defined and managed using XML configurations. \n\n---\n\n## Endpoints\n\n### Create VM\n\n- Endpoint: \/vms\n- Method: POST\n- Description: Create a new virtual machine.\n- Payload:\n json\n    {\n        \"name\": \"vm-name\",\n        \"iso_url\": \"http:\/\/path\/to\/iso\",\n        \"disk_size_gb\": 30,\n        \"memory_mb\": 4096,\n        \"vcpu_count\": 2\n    }\n    \n- Response: \n - Success: 202 Accepted - \"VM creation started\"\n - Failure: 500 Internal Server Error - \"Failed to download ISO\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms -H \"Content-Type: application\/json\" -d '{\n  \"name\": \"test-vm\",\n  \"iso_url\": \"http:\/\/example.com\/test.iso\",\n  \"disk_size_gb\": 20,\n  \"memory_mb\": 2048,\n  \"vcpu_count\": 2\n}'\n\n\n---\n\n### Modify VM\n\n- Endpoint: \/vms\/<vm_name>\/modify\n- Method: POST\n- Description: Modify an existing virtual machine.\n- Payload:\n json\n    {\n        \"memory_mb\": 8192,\n        \"vcpu_count\": 4,\n        \"disk_size_gb\": 40,\n        \"new_name\": \"new-vm-name\"\n    }\n    \n- Response: \n - Success: 200 OK - \"VM modified successfully\"\n - Failure: 404 Not Found - \"VM not found\"\n - Failure: 400 Bad Request - \"VM must be stopped before modification\"\n - Failure: 500 Internal Server Error - \"Failed to modify VM configuration\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms\/test-vm\/modify -H \"Content-Type: application\/json\" -d '{\n  \"memory_mb\": 8192,\n  \"vcpu_count\": 4,\n  \"disk_size_gb\": 40,\n  \"new_name\": \"test-vm-modified\"\n}'\n\n\n---\n\n### Unmount ISO\n\n- Endpoint: \/vms\/<vm_name>\/unmount_iso\n- Method: POST\n- Description: Unmount the ISO from the virtual machine.\n- Response: \n - Success: 200 OK - \"ISO unmounted and VM configuration updated\"\n - Failure: 404 Not Found - \"VM not found\"\n - Failure: 400 Bad Request - \"No CDROM device found\"\n - Failure: 400 Bad Request - \"Failed to update VM configuration\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms\/test-vm\/unmount_iso\n\n\n---\n\n### List VMs\n\n- Endpoint: \/vms\n- Method: GET\n- Description: List all virtual machines.\n- Response: 200 OK with a JSON array of VMs.\n\nExample:\n\nbash\ncurl -X GET http:\/\/localhost:5000\/vms\n\n\n---\n\n### Delete VM\n\n- Endpoint: \/vms\/<vm_name>\n- Method: DELETE\n- Description: Delete a virtual machine.\n- Response: \n - Success: 204 No Content - \"VM deleted\"\n - Failure: 404 Not Found - \"VM not found\"\n\nExample:\n\nbash\ncurl -X DELETE http:\/\/localhost:5000\/vms\/test-vm\n\n\n---\n\n### Start VM\n\n- Endpoint: \/vms\/<vm_name>\/start\n- Method: POST\n- Description: Start a virtual machine.\n- Response: \n - Success: 200 OK - \"VM started\"\n - Failure: 404 Not Found - \"VM not found\"\n - Failure: 404 Not Found - \"Disk image not found\"\n - Failure: 400 Bad Request - \"Failed to start VM\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms\/test-vm\/start\n\n\n---\n\n### Stop VM\n\n- Endpoint: \/vms\/<vm_name>\/stop\n- Method: POST\n- Description: Stop a virtual machine.\n- Response: \n - Success: 200 OK - \"VM stopped\"\n - Failure: 404 Not Found - \"VM not found\"\n - Failure: 400 Bad Request - \"Failed to stop VM\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms\/test-vm\/stop\n\n\n---\n\n### Export VM\n\n- Endpoint: \/vms\/<vm_name>\/export\n- Method: GET\n- Description: Export a virtual machine to a tar file.\n- Response: \n - Success: 200 OK - \"VM exported to \/path\/to\/tar\"\n - Failure: 404 Not Found - \"VM not found\"\n - Failure: 404 Not Found - \"Disk image not found\"\n - Failure: 400 Bad Request - \"VM must be stopped before export\"\n - Failure: 404 Not Found - \"Desktop directory not found\"\n\nExample:\n\nbash\ncurl -X GET http:\/\/localhost:5000\/vms\/test-vm\/export\n\n\n---\n\n### Export VM Compressed\n\n- Endpoint: \/vms\/<vm_name>\/exportCompressed\n- Method: GET\n- Description: Export a virtual machine to a compressed tar.gz file.\n- Response: \n - Success: 200 OK - \"VM exported to \/path\/to\/tar.gz\"\n - Failure: 404 Not Found - \"VM not found\"\n - Failure: 404 Not Found - \"Disk image not found\"\n - Failure: 400 Bad Request - \"VM must be stopped before export\"\n - Failure: 404 Not Found - \"Desktop directory not found\"\n\nExample:\n\nbash\ncurl -X GET http:\/\/localhost:5000\/vms\/test-vm\/exportCompressed\n\n\n---\n\n### Import VM\n\n- Endpoint: \/vms\/import\n- Method: POST\n- Description: Import a virtual machine from a tar file.\n- Payload: Form-data with a file field containing the tar file.\n- Response: \n - Success: 200 OK - \"VM imported successfully\"\n - Failure: 400 Bad Request - \"No file part\"\n - Failure: 400 Bad Request - \"No selected file\"\n - Failure: 404 Not Found - \"Desktop directory not found\"\n - Failure: 500 Internal Server Error - \"Failed to extract tar file\"\n - Failure: 400 Bad Request - \"Invalid tar file contents\"\n - Failure: 500 Internal Server Error - \"Failed to define VM\"\n - Failure: 500 Internal Server Error - \"Failed to redefine VM\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms\/import -F \"file=@\/path\/to\/tar\"\n\n\n---\n\n### Import VM Compressed\n\n- Endpoint: \/vms\/importCompressed\n- Method: POST\n- Description: Import a virtual machine from a compressed tar.gz file.\n- Payload: Form-data with a file field containing the tar.gz file.\n- Response: \n - Success: 200 OK - \"VM imported successfully\"\n - Failure: 400 Bad Request - \"No file part\"\n - Failure: 400 Bad Request - \"No selected file\"\n - Failure: 404 Not Found - \"Desktop directory not found\"\n - Failure: 500 Internal Server Error - \"Failed to extract tar.gz file\"\n - Failure: 400 Bad Request - \"Invalid tar.gz file contents\"\n - Failure: 500 Internal Server Error - \"Failed to define VM\"\n - Failure: 500 Internal Server Error - \"Failed to redefine VM\"\n\nExample:\n\nbash\ncurl -X POST http:\/\/localhost:5000\/vms\/importCompressed -F \"file=@\/path\/to\/tar.gz\"\n\n\n---\n\n## \u2699\ufe0f Setup\n\nTo set up the API, follow these steps:\n\n1. Clone the repository.\n2. Install the required packages:\n bash\n    pip install flask libvirt-python\n    \n3. Run the Flask app:\n bash\n    python scripts.py\n    \n\n## \ud83d\ude80 Usage\n\nUse the above endpoints to manage your virtual machines. Make sure to provide the required data in the correct format. \n\nHappy VM managing! \ud83d\udda5\ufe0f\u2728","created_at":"2024-07-02T05:28:47.000000Z","updated_at":"2024-07-02T05:28:47.000000Z","deleted_at":null,"model_type":1,"generation_type":0,"generation_from":0,"tag":null,"archived":0}
